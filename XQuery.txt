Es literalmente SQL para XML pero con una sintaxis un poco distinta
Todo lo que se haga con XPath puede hacerse en XQuery, pero no al reves
Sintaxis:

    for <variable> in <expresi贸n XPath> 
    let <variables vinculadas> 
    where <condici贸n XPath>
    order by <expresi贸n>
    return <expresi贸n de salida>

Un ejemplo:
    for $productos in //produc
    let $stock_real:=($productos/stock_actual)-($productos/stock_minimo)
    where $productos/cod_zona=10
    order by $productos/precio
    return <stock_real>{$stock_real}</stock_real>

Otro ejemplo:
    for $emp in /EMPLEADOS/EMP_ROW
    let $nom:=$emp/APELLIDO, $ofi:=$emp/OFICIO
    order by $emp/OFICIO
    return <APEOFI>{concat($nom,' ',$ofi)}</APEOFI>
Su version de XPath:
    //EMPLEADOS/EMP_ROW/concat("<APEOFI>",APELLIDO," ",OFICIO,"</APEOFI>")

RETURN:
    return <APEOFI>{concat($nom,' ',$ofi)}</APEOFI>
    return $nom
    return data($nom)
    return concat($nom,' ',$ofi)
    return <a>{concat($nom,' ',$ofi)}</a>
en el return puede haber un condicional:
    return if ($dep/@tipo='A')
	    then <tipoA>{data($dep/nombre)}</tipoA>
	    else ()

Modificar elementos usando xquery
update insert ELEMENTO into EXPRESION 
update insert ELEMENTO following EXPRESION 
update insert ELEMENTO preceding EXPRESION
update insert attribute ELEMENTO into EXPRESION

Ejemplo:
update insert 
    <zona>
        <codzona>50</codzona> 
        <nombre>Madrid-OESTE </nombre> 
        <director>Alicia Ramos Martin</director>
    </zona> 
    into /zonas

Ejemplo con condicional:

update insert 
    <zona>
        <codzona>50</codzona> 
        <nombre>Madrid-OESTE </nombre> 
        <director>Alicia Ramos Martin</director>
    </zona> 
    preceding //zona[cod_zona=40]

update insert 
    <cuenta tipo="PENSIONES">
        <nombre>Alberto Morales </nombre>
        <numero>30302900</numero> 
        <aportacion>5000</aportacion>
    </cuenta> 
    into /sucursales/sucursal[@codigo="SUC1"]

Uso de replace (replaza un unico nodo):

update replace NODO with VALOR NUEVO

update replace 
    /zonas/zona[codzona=50]/director 
    with 
        <directora>Pilar Martin Ramos</directora>

update replace 
    /departamentos/DEP_ROW[DEPT_NO=10] 
    with 
        <DEP_ROW>
            <DEPT_NO>10</DEPT_NO>
            <DNOMBRE>NUEVO10</DNOMBRE>
            <LOC>TALAVERA</LOC>
        </DEP_ROW>

Update para un valor especifico:

update value NODO with 'VALOR NUEVO'

update 
    value /sucursales/sucursal[@codigo='SUC3']/cuenta[1]/@tipo 
    with 'NUEVOTIPO'

update 
    value /sucursales/sucursal[@codigo='SUC3']/cuenta[@tipo="PENSIONES"]/aportacion
    with 5555

for $em in /EMPLEADOS/EMP_ROW[DEPT_NO=10]
let $sal:=$em/SALARIO
return update value $em/SALARIO with data($sal)+200

for $em in /EMPLEADOS/EMP_ROW[DEPT_NO=10]
let $sal:=$em/SALARIO
return update value $sal with $sal+200

for $em in /EMPLEADOS/EMP_ROW[DEPT_NO=10]
let $sal:=$em/SALARIO/text()
return update value $em/SALARIO with $sal+200

update delete //zona[codzona=50]

Otro ejemplo:

for $dep in /zonas/zona/cod_zona
return 
update delete $dep

update rename /EMPLEADOS/EMP_ROW as 'fila_emple'

====================================================
for $em in /EMPLEADOS/EMP_ROW[DEPT_NO=20]
let $sal:=$em/SALARIO
return update insert <nuevosal>{$sal*1.10}</nuevosal> into $em
====================================================
update delete /EMPLEADOS/EMP_ROW[DEPT_NO=20]/nuevosal
====================================================